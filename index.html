<!DOCTYPE html>
<html>
<head>
    <title>Poke-Battler: API Edition</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #1a1a2e; color: #fff; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        #game-container { background: #16213e; border: 3px solid #e94560; width: 500px; padding: 20px; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .stats-bar { display: flex; justify-content: space-between; background: #0f3460; padding: 10px; border-radius: 8px; margin-bottom: 20px; }
        
        /* Enemy & Party Visuals */
        .battle-scene { display: flex; justify-content: space-around; align-items: center; margin-bottom: 20px; background: #1a1a2e; padding: 10px; border-radius: 10px; }
        .unit-box { text-align: center; width: 150px; }
        .sprite { width: 100px; height: 100px; image-rendering: pixelated; }
        
        .hp-bar { background: #444; height: 10px; width: 100%; border-radius: 5px; margin-top: 5px; overflow: hidden; }
        #enemy-hp-fill { background: #ff4d4d; height: 100%; width: 100%; transition: width 0.3s; }
        
        .party-list { display: flex; gap: 10px; justify-content: center; margin: 15px 0; }
        .party-member { font-size: 0.8rem; background: #0f3460; padding: 5px; border-radius: 5px; border: 1px solid #444; }

        .controls button { width: 100%; margin: 5px 0; padding: 12px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; }
        .btn-attack { background: #e94560; color: white; }
        .btn-upgrade { background: #0f3460; color: #00ffcc; border: 1px solid #00ffcc; }
        #log { height: 100px; overflow-y: auto; background: #1a1a2e; padding: 10px; margin-top: 15px; font-size: 0.85rem; border-radius: 5px; text-align: left; }
    </style>
</head>
<body>

    <div id="game-container">
        <div class="stats-bar">
            <span>üí∞ $<span id="credits">0</span></span>
            <span>üèÜ Lv: <span id="party-level">1</span></span>
        </div>

        <div class="battle-scene">
            <div class="unit-box">
                <img id="player-sprite" class="sprite" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/1.png">
                <div id="player-name">Bulbasaur</div>
            </div>
            <div style="font-size: 1.5rem; font-weight: bold;">VS</div>
            <div class="unit-box">
                <img id="enemy-sprite" class="sprite" src="">
                <div id="enemy-name">Loading...</div>
                <div style="font-size: 0.8rem;">HP: <span id="enemy-hp-text">x</span>/50</div>
                <div class="hp-bar"><div id="enemy-hp-fill"></div></div>
            </div>
        </div>

        <div class="party-list" id="party-ui"></div>
        
        <div class="controls">
            <button class="btn-attack" onclick="attackEnemy()">ATTACK!</button>
            <button class="btn-upgrade" onclick="buyUpgrade()">TRAIN PARTY (Cost: $<span id="upgrade-cost">50</span>)</button>
        </div>

        <div id="log">A wild Pok√©mon appears!</div>
    </div>

<script>
    // Game State
    let credits = 0;
    let partyLevel = 1;
    let upgradeCost = 50;
    let party = [
        { name: "Bulbasaur", id: 1 },
        { name: "Charmander", id: 4 },
        { name: "Squirtle", id: 7 }
    ];
    
    // Enemy State
    let enemyHp = 50;
    let enemyMaxHp = 50;

    // Initialize Game
    async function spawnEnemy() {
        const randomID = Math.floor(Math.random() * 151) + 1; // Gen 1
        const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${randomID}`);
        const data = await response.json();
        
        document.getElementById('enemy-name').innerText = data.name.toUpperCase();
        document.getElementById('enemy-sprite').src = data.sprites.front_default;
        
        enemyMaxHp = 50 + (partyLevel * 10);
        enemyHp = enemyMaxHp;
        updateDisplay();
    }

    function updateDisplay() {
        document.getElementById('credits').innerText = credits;
        document.getElementById('party-level').innerText = partyLevel;
        document.getElementById('upgrade-cost').innerText = upgradeCost;
        
        // HP Display
        document.getElementById('enemy-hp-text').innerText = Math.max(0, enemyHp);
        const hpPercent = (enemyHp / enemyMaxHp) * 100;
        document.getElementById('enemy-hp-fill').style.width = hpPercent + "%";

        // Party UI
        const partyUI = document.getElementById('party-ui');
        partyUI.innerHTML = party.map(p => `<div class="party-member">${p.name}</div>`).join('');
    }

    function attackEnemy() {
        // Damage scales with party level
        let damage = 10 + (partyLevel * 5) + Math.floor(Math.random() * 5);
        enemyHp -= damage;
        log(`Your party dealt ${damage} damage!`);

        if (enemyHp <= 0) {
            victory();
        }
        updateDisplay();
    }

    function victory() {
        let reward = 20 + (partyLevel * 5);
        credits += reward;
        log(`VICTORY! Gained $${reward}.`, "#fbd000");
        spawnEnemy();
    }

    function buyUpgrade() {
        if (credits >= upgradeCost) {
            credits -= upgradeCost;
            partyLevel++;
            upgradeCost = Math.floor(upgradeCost * 1.7);
            log(`Your party leveled up to ${partyLevel}!`, "#00ffcc");
            updateDisplay();
        } else {
            log("Not enough credits!");
        }
    }

    function log(msg, color="#fff") {
        const l = document.getElementById('log');
        l.innerHTML = `<span style="color:${color}">> ${msg}</span><br>${l.innerHTML}`;
    }

    spawnEnemy(); // Start first encounter
</script>
</body>
</html>
